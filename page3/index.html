<!DOCTYPE html>
<html lang="ru">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Блог Павла Попова</title>
  <meta name="title" content="">
  <meta name="description" content="Павел Попов">

  <meta property="og:url" content="/page3/index.html">
  <meta property="og:title" content="">
  
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="Павел Попов">
  <link rel="icon" type="image/png" href="/public/favicon.ico">
  <link rel="alternate" type="application/rss+xml" title="Блог Павла Попова" href="/blog-feed.xml">
  <link href="http://fonts.googleapis.com/css?family=PT+Serif:400,700,400italic|PT+Sans:400,700,400italic|Roboto:100,300|Roboto+Slab:300,400&amp;subset=latin,cyrillic" rel="stylesheet">
  <link href="/public/css/main.css" rel="stylesheet">

  <!-- CSS -->
  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Custom -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
  <link  href="http://fotorama.s3.amazonaws.com/4.6.0/fotorama.css" rel="stylesheet"> <!-- 3 KB -->
<script src="http://fotorama.s3.amazonaws.com/4.6.0/fotorama.js"></script> <!-- 16 KB -->
  <script src="/public/js/dug.js"></script>
  <script src="/public/js/application.js"></script>
</head>

<body>
<header class="row-1">
  <nav class="title-nav" role="navigation">
    <h1 class="title-nav-header"><a href="/">Павел Попов</a>
      <span class="title-nav-slash">/</span>
      <a href="/">Блог</a>
    </h1>
  </nav>
</header>

  <section class="entry-list row-1" role="main">
  
    <article class="entry">
      
  
  
  



  


  <header class="entry-header">
    <h1 class="entry-title">
      <a href="/running-workflow-in-parallel-in-informatica-powercenter/">Параллельный запуск потока в Informatica PowerCenter</a>
    </h1>
  </header>

  <div class="entry-body content-area">
    

    <p>В Informatica PowerCenter есть возможность запускать в параллельном режиме один поток (workflow) в разных инстансах. Данный метод запуска очень выгодно использовать для загрузки данных, которые хорошо партиционируются. Например, загрузку данных за месяц можно запустить параллельно в 4 потока по неделе или сделать подневную загрузку в N потоков.</p>

<p>Количество одновременных потоков надо выбирать исходя из производительности платформы. При увеличении числа потоков сначала идет практически линейный рост производительности, затем все начинает упираться в узкое место платформы (IO, CPU, RAM, Network) и дальнейшее увеличение количества параллельных потоков только замедляет скорость работы системы.</p>

<p>Чтобы поток мог работать в параллельном режиме, надо в настройках потока включить опцию “Configure Concurrent Execution”. В настройках Concurrent Execution лучше использовать опцию “Allow concurrent run only with unique instance name” иначе потом не разберешься какой именно параллельный запуск за какую часть работы отвечает. Нужно указать имя инстанса и параметрический файл. Обычно эти значения совпадают с таковыми у потока.</p>

<p>Запустить поток в параллель возможно только из командной строки через <code>pmcmd</code>. Скорее всего вам понадобится уникальный параметрический файл для каждого инстанса (например, разные периоды загрузки). В этом случае, в вашем диспетчере загрузок или управляющем механизме, который генерирует файл параметров, нужно предусмотреть процедуру сохранения файла параметров с уникальным именем.</p>

<p>Я это делал просто – диспетчер создает параметрический файл <code>wf_WFNAME.param</code> и командный файл для запуска потока. В командном файле сначала файл <code>wf_WFNAME.param</code> копируется в <code>wf_WFNAME_xxxx.param</code>, где <code>xxxx</code> – уникальный номер запуска потока, а затем вызывается <code>pmcmd</code>:</p>

<pre><code>param_dir=/informatica/pc/server/infa_shared/DEV/Param/
bin_dir=/informatica/pc/server/bin 
cp $param_dir/wf_CALC.param $param_dir/wf_CALC_1712.param

$bin_dir/pmcmd startworkflow -service SERVICE_NAME
                             -domain DOMAIN_NAME
                             -user username
                             -password pwd
                             -folder FOLDER_NAME
                             -paramfile $param_dir/wf_WFNAME_1712.param
                             -runinsname wf_WFNAME_1712
                             wf_WFNAME
</code></pre>

<h3 id="to-do">To Do</h3>

<ul>
  <li>добавить скриншоты настроек параллельного запуска</li>
  <li>добавить анализ скорости выполнения задачи от количества параллельных инстансов</li>
  <li>описать работу диспетчера задач</li>
</ul>



    
      <a href="/running-workflow-in-parallel-in-informatica-powercenter/" class="read-link">Читать</a>
    
  </div>

  

    </article>
  
    <article class="entry">
      
  
  
  



  


  <header class="entry-header">
    <h1 class="entry-title">
      <a href="/raspberry-pi-setup-and-ssh-through-browser/">Установка Raspberry Pi и настройка SSH через браузер</a>
    </h1>
  </header>

  <div class="entry-body content-area">
    

    <p>Настало время поставить что-нибудь дельное на мой Raspberry Pi Model A.</p>

<p><img src="/assets/raspberrypi/raspberry_pi_logo1.png" alt="raspberry pi logo" /></p>

<h2 id="wifi--">ОС, WiFi и драйвера</h2>

<p>В качестве операционной системы поставил <a href="http://www.raspbian.org">Raspbian</a>, сеть – купил WiFi-адаптер <a href="http://www.tp-linkru.com/products/details/?categoryid=243&amp;model=TL-WN725N">TL-WN725N</a> за 310 рублей в Юлмарте.</p>

<p>Драйвера для WiFi-адаптера ставятся простым копированием файлов в нужные директории, полное описание процесса установки есть в блоге <a href="http://www.mendrugox.net/2013/08/tp-link-tl-wn725n-v2-working-on-raspberry-raspbian/">mendrugox</a>. Только надо внимательно следить, чтобы драйвера были скомпилированы именно под нужную версию Raspbian.</p>

<p>Драйвер для версии <code>2013-09-25-wheezy-raspbian</code>: <a href="/assets/raspberrypi/8188eu.ko">8188eu.ko</a> (Compiled in 2013-10) (Working in kernel Linux raspberrypi 3.6.11+ #538 PREEMPT).</p>

<p>Файл кидаем на SD-карточку, после чего из Raspberry находим его в каталоге <code>/boot</code>. Копируем в</p>

<pre><code>/lib/modules/(your-kernel-version)/kernel/drivers/net/wireless
</code></pre>

<p>и запускаем:</p>

<pre><code>depmod -a
modprobe 8188eu
</code></pre>

<p>После этого должно появиться устройство <code>wlan0</code>, с которым можно уже работать.</p>

<p>Исходный код: <a href="/assets/raspberrypi/rtl8188eu.tgz">rtl8188eu.tgz</a></p>

<p>Я не стал мучаться с настройкой WiFi через командную строку, а настроил все через графический интерфейс. Все работает и загружается при старте системы.</p>

<h2 id="ssh-----dns">SSH через браузер и динамический DNS</h2>

<p>Решил поставить браузерную версию ssh, чтобы можно было зайти на него с работы (любой не http(s)-трафик у нас режут).</p>

<p>Для этого сначала поставил <a href="http://nodejs.org">nodejs</a>, затем <a href="https://github.com/chjj/tty.js/">tty.js</a>:</p>

<pre><code>apt-get install nodejs, npm
npm install tty.js
</code></pre>

<p>После этого его сразу можно поднимать и работать:</p>

<pre><code>nodejs tty.js --daemonize
</code></pre>

<p>Конфигурационный файл по-умолчанию лежит в <code>~/.tty.js/config.json</code>.</p>

<p>Единственное, чего я пока не понял – как сделать шелл с приглашением к логину, а то сейчас сразу открывается терминал из под пользователя, запустившего <code>tty.js</code>.</p>

<p>Аутентификация – стандартная HTTP-authentication. Надо будет еще с HTTPS заморочиться, чтобы вообще все было хорошо.</p>

<p>Дальше, выводим наш Raspberry в интернет.</p>

<p>Есть сервис <a href="https://pagekite.net">pagekite</a>, который привязывает к вашему динамическому IP доменное имя вида <code>username.pagekite.me</code>. Бесплатный и с открытым исходным кодом, все настраивается и быстро устанавливается, можно даже привязать свой CNAME.</p>

<p>Все настроил, теперь у меня Raspberry доступен из интернета.</p>

<p>Правда это штука, pagekite, достаточно сильно грузит процессор – примерно 7-8% на сессию. Видимо, программно осуществляет роутинг пакетов.</p>

<p>Надо будет приделать к нему настоящий DDNS. К сожалению, почти все хотят за это сейчас денег, причем немаленьких. Есть наброски по использованию Yandex Public DNS и прописыванием адреса через API. Сделаю – напишу.</p>

<h2 id="section">Скриншоты</h2>

<div class="photos">
  <img src="/assets/raspberrypi/screenshot-1.png" data-caption="Nyancat в терминале, pagekite жрет 25% процессора" />
  <img src="/assets/raspberrypi/screenshot-2.png" data-caption="Без нагрузки pagekite жрет 6-7% процессора" />
</div>



    
  </div>

  

    </article>
  
    <article class="entry">
      
  
  
  



  


  <header class="entry-header">
    <h1 class="entry-title">
      <a href="/first-word-hyphenation-in-latex/">Перенос первого слова в параграфе в LaTeX</a>
    </h1>
  </header>

  <div class="entry-body content-area">
    

    <p>При верстке таблиц в LaTeX может возникнуть еще одна проблема – если у вас в ячейке одно слово, то LaTeX не будет его переносить, даже если слово длинное и не умещается по ширине в ячейку типа <code>p</code>. Все из-за того, что сложность алгоритма расстановки переносов в случае допущений, в числе которых и отсутствие необходимости переносить первое слово, падает с О(n<sup>2</sup>) до O(n). Подробности <a href="https://en.wikipedia.org/wiki/TeX#Hyphenation_and_justification">в английской Википедии</a>.</p>

<p>Но TeX можно обмануть! Нужно лишь первым символом параграфа сделать неразрывный пробел нулевой длины – <code>\hspace{0pt}</code>. Примеры использования: <a href="http://sigstp.blogspot.ru/2010/09/latex-hyphenate-single-long-words-in.html">раз</a>, <a href="http://tex.stackexchange.com/questions/67762/hyphenation-rule-not-acted-upon">два</a>.</p>

<p>Вставлять каждый раз в нужное место код очень неудобно, особенно если контент приходит из вне, поэтому можно сделать это автоматически. После достаточно долгих поисков я нашел <a href="http://tex.stackexchange.com/questions/78127/how-does-latex-make-line-breaking-for-word-that-can-not-fit-in-cell">вот этот совет</a> на TeX StackExchange – нужно в опциях табличного окружения воспользоваться синтаксисом <code>&gt;{...}</code> из пакета <code>array</code>, например так:</p>

<pre><code>...
\usepackage{array}
...
\begin{longtable}{|&gt;{\hspace{0pt}}p{0.1\textwidth} | p{0.3\textwidth}|} \hline
...
</code></pre>

<p>После этого все сразу станет гораздо красивее.</p>



    
  </div>

  

    </article>
  
    <article class="entry">
      
  
  
  



  


  <header class="entry-header">
    <h1 class="entry-title">
      <a href="/clip-option-in-gnuplot/">Опция clip в gnuplot</a>
    </h1>
  </header>

  <div class="entry-body content-area">
    

    <p>У gnuplot есть опция <a href="http://gnuplot.sourceforge.net/docs_4.2/node165.html">clip</a>, которая начинает скрывать линии и точки на графике, если они подходят близко к осям. В моем случае, я рисовал линию между двумя точками, причем текущий <code>xrange</code> оказывался по оси <em>x</em> между этими точками, но не захватывал ни одну из них. В этом случае (по-умолчанию point clip is OFF) gnuplot не рисует линию. Пришлось сказать <code>set clip two</code> и линия появилась.</p>



    
  </div>

  

    </article>
  
    <article class="entry">
      
  
  
  



  


  <header class="entry-header">
    <h1 class="entry-title">
      <a href="/using-longtabu-in-latex/">Использование longtabu в LaTeX</a>
    </h1>
  </header>

  <div class="entry-body content-area">
    

    <p>Стандартный <code>tabular</code> не поддерживает таблицы, которые не умещаются в одну страницу.</p>

<p>Для многостраничных таблиц есть пакет <code>longtable</code>, он разбивает таблицу на страницы, 
причем на каждой странице может выводить свой заголовок. Доступны следующие команды:
<code>\endfirsthead</code>, <code>\endhead</code>, <code>\endlastfoot</code>, <code>\endfoot</code>.
Они определяют заголовок на первой странице таблицы и на остальных страницах таблицы.
И подвал страницы на последней и остальных страницах, соответственно.</p>

<p>Примеры использования можно поискать в Гугле или, например, <a href="http://texblog.org/2011/05/15/multi-page-tables-using-longtable/">тут</a>.</p>

<p>Проблемы с <code>longtable</code> начинаются, если в таблице оказываются длинные данные. TeX 
по-умолчанию не умеет переносить содержимое ячеек на новую строчку. Чтобы активировать
перенос тип колонки должен быть не <code>l</code>,<code>r</code> или <code>c</code> (выравнивание влево, вправо или по
центру) а <code>p</code> (параграф) с указанием ширины в понятных для TeXа элементах (например, 
<code>p{1.1cm}</code>). Тогда, определив для каждой колонки размер, соотнеся его с <code>\textwidth</code>
можно добиться нормального расположения таблицы на странице (без сообщений в логе 
<code>Overfull \hbox</code>).</p>

<p>К счастью, есть более правильный способ – использование пакета <a href="http://www.ctan.org/pkg/tabu"><code>tabu</code></a>. Он
добавляет к возможностям окружения <code>tabular</code> новый тип колонок - <code>X</code>. Это колонка,
ширина которой будет вычисляться автоматически.</p>

<p>Пример таблицы в окружении <code>tabu</code>:</p>

<pre><code>\begin{tabu} to \linewidth{lXr}

$r_1c_1$ &amp; $r_1c_2$ &amp; $r_1c_3$ \\
$r_2c_1$ &amp; $r_2c_2$ &amp; $r_2c_3$ \\
$r_3c_1$ &amp; $r_3c_2$ &amp; $r_3c_3$ \\

\end{tabu}
</code></pre>

<p>У <code>X</code> может быть несколько параметров - вес коэффициента ширины ячейки (число),
выравнивание по горизонтали и вертикали. Например, если нужна колонка в 2 раза шире
чем обычная и выровненная по правому краю, для нее указываем <code>X[2,r]</code>.</p>

<p>У пакета <code>tabu</code> есть окружение <code>longtabu</code>, расширяющее функционал пакета <code>longtable</code>
колонками типа <code>X</code>. Чтобы его использовать, надо подключить оба пакета <code>tabu</code> и <code>longtable</code>.</p>

<p>Команды заголовков и подвала <code>longtabu</code> наследует от <code>longtable</code>.</p>

<p>У меня возникли проблемы с <code>longtabu</code> когда у меня в заголовке были многоколоночные
ячейки (<code>\multicolumn</code>). Для них нельзя указать тип <code>X</code>, поэтому заголовок у меня не
попадал в основную таблицу. К сожалению, <code>\multicolumn</code> для <code>tabu</code> еще не реализован,
так что приходится использовать workaround через <code>\tabuphantomline</code>, примерно так:</p>

<pre><code>\begin{longtabu} to \linewidth{|r|X[L]|r|X[L]|r|X[L]|X[R]|l|} \tabucline-

\hline
\multicolumn2{|c|}{COLUMN1} &amp; \multicolumn2{c|}{COLUMN2} &amp; \multicolumn4{c|}{COLUMN3} \\ \tabucline-
\tabuphantomline
\hline
\endfirsthead
...
\end{longtabu}
</code></pre>

<p>Здесь используется таблица с 8 колонками разного типа. Заголовки многоколоночные,
ширина получается точно такая, как у ячеек таблицы.</p>

<p>Использование этого workaround не совсем очевидно из документации, но это работает.</p>



    
  </div>

  

    </article>
  
    <article class="entry">
      
  
  
  



  


  <header class="entry-header">
    <h1 class="entry-title">
      <a href="/centos-cheatsheet/">Cheatsheet по CentOS</a>
    </h1>
  </header>

  <div class="entry-body content-area">
    

    <p>Буду собирать полезные команды по CentOS в одном месте.</p>

<ul>
  <li><code>chkconfig</code> – команда, проверяющая автоматический запуск сервисов. <code>chkconfig
--list httpd</code> покажет, на каких ранлевелах стартует веб-сервер (Апач) при
загрузке. Добавить сервис в автозапуск можно с помощью <code>chkconfig --levels
2345 httpd on</code></li>
  <li>Чтобы подключить <a href="http://fedoraproject.org/wiki/EPEL">EPEL</a>, репозиторий с
большим количеством различных пакетов (например, <code>pip</code> для питона), нужно
поставить rpm-пакет epel. Подробности – в <a href="http://fedoraproject.org/wiki/EPEL/FAQ#How_can_I_install_the_packages_from_the_EPEL_software_repository.3F">FAQ</a> Epel.</li>
  <li>
    <p>Чтобы настроить таймзону нужно скопировать в <code>/etc/localtime</code> одну из таймзон
из <code>/usr/share/zoneinfo</code>, например для Москвы:</p>

    <pre><code># ln -sf /usr/share/zoneinfo/Europe/Moscow localtime
</code></pre>

    <p>Тогда часы сразу изменятся и команда <code>date</code> будет выдавать правильное время.</p>

    <p>Подробности <a href="http://www.cyberciti.biz/faq/howto-linux-unix-change-setup-timezone-tz-variable/">тут</a>.</p>
  </li>
</ul>



    
  </div>

  

    </article>
  
    <article class="entry">
      
  
  
  



  


  <header class="entry-header">
    <h1 class="entry-title">
      <a href="/trying-rbenv/">Использование rbenv в качестве менеджера пакетов Ruby</a>
    </h1>
  </header>

  <div class="entry-body content-area">
    

    <p>Попробовал использовать <a href="https://github.com/sstephenson/rbenv">rbenv</a> в качестве менеджера версий <a href="http://www.ruby-lang.org">ruby</a>. По
сравнению с <a href="https://rvm.io">rvm</a>, который я использовал раньше, это словно глоток свежего
воздуха. Простая и понятная установка, когда сам руками клонируешь нужные
репозитории из гитхаба, 2 строчки в .rc файл и собственно все, установка
закончена. Далее выбираешь нужную версию ruby и поехали. С rvm я никак не мог
понять, в какой версии я нахожусь, что надо сделать, чтобы оно заработало.</p>

<p>Я, конечно, не ruby-разработчик, поэтому это мои “ламерские” выводы, я обеими
системами я работал очень мало, но понятность и простота rbenv подкупают.</p>

<p>Единственное, что не указано в документации в разделе “Установка”, а указано
гораздо ниже – после установки с помощью <code>$ rbenv install ruby-1.9.3-p448</code>
нужно задать используемую версию руби с помощью <code>$ rbenv local 1.9.3-p448</code>.</p>

<p>Также мне понадобилось установить пакет <code>zlib-devel</code> для корректной работы <code>gem
install</code>. Возникала ошибка <a href="http://stackoverflow.com/questions/9727908/cannot-load-such-file-zlib-even-after-using-rvm-pkg-install-zlib">Cannot load such file – zlib</a>.
После установки нужно переустановить версию руби.</p>



    
  </div>

  

    </article>
  
  <a href="/archive/" class="archive-link">→</a>
</section>



  <!-- Yandex.Metrika counter -->
<script type="text/javascript">
(function (d, w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            w.yaCounter21201856 = new Ya.Metrika({id:21201856,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true});
        } catch(e) { }
    });

    var n = d.getElementsByTagName("script")[0],
        s = d.createElement("script"),
        f = function () { n.parentNode.insertBefore(s, n); };
    s.type = "text/javascript";
    s.async = true;
    s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

    if (w.opera == "[object Opera]") {
        d.addEventListener("DOMContentLoaded", f, false);
    } else { f(); }
})(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="//mc.yandex.ru/watch/21201856" style="position:absolute; left:-9999px;" alt="" /></div>
</noscript>
<!-- /Yandex.Metrika counter -->

</body>
</html>
