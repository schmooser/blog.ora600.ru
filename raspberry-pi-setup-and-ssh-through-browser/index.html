<!DOCTYPE html>
<html lang="ru">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Блог Павла Попова</title>
  <meta name="title" content="Установка Raspberry Pi и настройка SSH через браузер">
  <meta name="description" content="Павел Попов">

  <meta property="og:url" content="/raspberry-pi-setup-and-ssh-through-browser/">
  <meta property="og:title" content="Установка Raspberry Pi и настройка SSH через браузер">
  
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="Павел Попов">
  <link rel="icon" type="image/png" href="/public/favicon.ico">
  <link rel="alternate" type="application/rss+xml" title="Блог Павла Попова" href="/blog-feed.xml">
  <link href="http://fonts.googleapis.com/css?family=PT+Serif:400,700,400italic|PT+Sans:400,700,400italic|Roboto:100,300|Roboto+Slab:300,400&amp;subset=latin,cyrillic" rel="stylesheet">
  <link href="/public/css/main.css" rel="stylesheet">

  <!-- CSS -->
  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Custom -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
  <link href="http://fotorama.s3.amazonaws.com/4.4.9/fotorama.css" rel="stylesheet">
  <script src="http://fotorama.s3.amazonaws.com/4.4.9/fotorama.js"></script>
  <script src="/public/js/dug.js"></script>
  <script src="/public/js/application.js"></script>
</head>

<body>
<header class="row-1">
  <nav class="title-nav" role="navigation">
    <h1 class="title-nav-header"><a href="/">Павел Попов</a>
      <span class="title-nav-slash">/</span>
      <a href="/">Блог</a>
    </h1>
  </nav>
</header>

  <section class="single-entry row-1" role="main">
  
  
  
  




<article class="entry">
  <header class="entry-header">
    <h1 class="entry-title">
      <a href="/raspberry-pi-setup-and-ssh-through-browser/">Установка Raspberry Pi и настройка SSH через браузер</a>
    </h1>
  </header>

  <div class="entry-body content-area">
    

    <p>Настало время поставить что-нибудь дельное на мой Raspberry Pi Model A.</p>

<p><img src="/assets/raspberrypi/raspberry_pi_logo1.png" alt="raspberry pi logo" /></p>

<h2 id="wifi--">ОС, WiFi и драйвера</h2>

<p>В качестве операционной системы поставил <a href="http://www.raspbian.org">Raspbian</a>, сеть – купил WiFi-адаптер <a href="http://www.tp-linkru.com/products/details/?categoryid=243&amp;model=TL-WN725N">TL-WN725N</a> за 310 рублей в Юлмарте.</p>

<p>Драйвера для WiFi-адаптера ставятся простым копированием файлов в нужные директории, полное описание процесса установки есть в блоге <a href="http://www.mendrugox.net/2013/08/tp-link-tl-wn725n-v2-working-on-raspberry-raspbian/">mendrugox</a>. Только надо внимательно следить, чтобы драйвера были скомпилированы именно под нужную версию Raspbian.</p>

<p>Драйвер для версии <code>2013-09-25-wheezy-raspbian</code>: <a href="/assets/raspberrypi/8188eu.ko">8188eu.ko</a> (Compiled in 2013-10) (Working in kernel Linux raspberrypi 3.6.11+ #538 PREEMPT).</p>

<p>Файл кидаем на SD-карточку, после чего из Raspberry находим его в каталоге <code>/boot</code>. Копируем в</p>

<pre><code>/lib/modules/(your-kernel-version)/kernel/drivers/net/wireless
</code></pre>

<p>и запускаем:</p>

<pre><code>depmod -a
modprobe 8188eu
</code></pre>

<p>После этого должно появиться устройство <code>wlan0</code>, с которым можно уже работать.</p>

<p>Исходный код: <a href="/assets/raspberrypi/rtl8188eu.tgz">rtl8188eu.tgz</a></p>

<p>Я не стал мучаться с настройкой WiFi через командную строку, а настроил все через графический интерфейс. Все работает и загружается при старте системы.</p>

<h2 id="ssh-----dns">SSH через браузер и динамический DNS</h2>

<p>Решил поставить браузерную версию ssh, чтобы можно было зайти на него с работы (любой не http(s)-трафик у нас режут).</p>

<p>Для этого сначала поставил <a href="http://nodejs.org">nodejs</a>, затем <a href="https://github.com/chjj/tty.js/">tty.js</a>:</p>

<pre><code>apt-get install nodejs, npm
npm install tty.js
</code></pre>

<p>После этого его сразу можно поднимать и работать:</p>

<pre><code>nodejs tty.js --daemonize
</code></pre>

<p>Конфигурационный файл по-умолчанию лежит в <code>~/.tty.js/config.json</code>.</p>

<p>Единственное, чего я пока не понял – как сделать шелл с приглашением к логину, а то сейчас сразу открывается терминал из под пользователя, запустившего <code>tty.js</code>.</p>

<p>Аутентификация – стандартная HTTP-authentication. Надо будет еще с HTTPS заморочиться, чтобы вообще все было хорошо.</p>

<p>Дальше, выводим наш Raspberry в интернет.</p>

<p>Есть сервис <a href="https://pagekite.net">pagekite</a>, который привязывает к вашему динамическому IP доменное имя вида <code>username.pagekite.me</code>. Бесплатный и с открытым исходным кодом, все настраивается и быстро устанавливается, можно даже привязать свой CNAME.</p>

<p>Все настроил, теперь у меня Raspberry доступен из интернета.</p>

<p>Правда это штука, pagekite, достаточно сильно грузит процессор – примерно 7-8% на сессию. Видимо, программно осуществляет роутинг пакетов.</p>

<p>Надо будет приделать к нему настоящий DDNS. К сожалению, почти все хотят за это сейчас денег, причем немаленьких. Есть наброски по использованию Yandex Public DNS и прописыванием адреса через API. Сделаю – напишу.</p>

<h2 id="section">Скриншоты</h2>

<div class="photos">
  <img src="/assets/raspberrypi/screenshot-1.png" data-caption="Nyancat в терминале, pagekite жрет 25% процессора" />
  <img src="/assets/raspberrypi/screenshot-2.png" data-caption="Без нагрузки pagekite жрет 6-7% процессора" />
</div>



    
  </div>

  
  <footer class="entry-footer">
    <time class="entry-timestamp">26 Oct 2013</time>
  </footer>
  
</article>

</section>



  <!-- Yandex.Metrika counter -->
<script type="text/javascript">
(function (d, w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            w.yaCounter21201856 = new Ya.Metrika({id:21201856,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true});
        } catch(e) { }
    });

    var n = d.getElementsByTagName("script")[0],
        s = d.createElement("script"),
        f = function () { n.parentNode.insertBefore(s, n); };
    s.type = "text/javascript";
    s.async = true;
    s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

    if (w.opera == "[object Opera]") {
        d.addEventListener("DOMContentLoaded", f, false);
    } else { f(); }
})(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="//mc.yandex.ru/watch/21201856" style="position:absolute; left:-9999px;" alt="" /></div>
</noscript>
<!-- /Yandex.Metrika counter -->

</body>
</html>
