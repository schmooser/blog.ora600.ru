<!DOCTYPE html>
<html lang="ru">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Блог Павла Попова</title>
  <meta name="title" content="">
  <meta name="description" content="Павел Попов">

  <meta property="og:url" content="/page2/index.html">
  <meta property="og:title" content="">
  
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="Павел Попов">
  <link rel="icon" type="image/png" href="/public/favicon.ico">
  <link rel="alternate" type="application/rss+xml" title="Блог Павла Попова" href="/blog-feed.xml">
  <link href="http://fonts.googleapis.com/css?family=PT+Serif:400,700,400italic|PT+Sans:400,700,400italic|Roboto:100,300|Roboto+Slab:300,400&amp;subset=latin,cyrillic" rel="stylesheet">
  <link href="/public/css/main.css" rel="stylesheet">

  <!-- CSS -->
  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Custom -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
  <link href="http://fotorama.s3.amazonaws.com/4.4.9/fotorama.css" rel="stylesheet">
  <script src="http://fotorama.s3.amazonaws.com/4.4.9/fotorama.js"></script>
  <script src="/public/js/dug.js"></script>
  <script src="/public/js/application.js"></script>
</head>

<body>
<header class="row-1">
  <nav class="title-nav" role="navigation">
    <h1 class="title-nav-header"><a href="/">Павел Попов</a>
      <span class="title-nav-slash">/</span>
      <a href="/">Блог</a>
    </h1>
  </nav>
</header>

  <section class="entry-list row-1" role="main">
  
    
  
  
  



  


<article class="entry">
  <header class="entry-header">
    <h1 class="entry-title">
      <a href="/life-timeline/">Таймлайн моей жизни на javascript</a>
    </h1>
  </header>

  <div class="entry-body content-area">
    

    <p>На <a href="https://news.ycombinator.com/item?id=6833565">HackerNews</a> нашел занятный проект – <a href="https://github.com/cheeaun/life">Life</a> – крошечный javascript, который превращает список событий в красивый таймлайн. Форкнул и внес свою жизнь на таймлайн, получилось занятно – <a href="http://iseetheline.ru/life/">My Life</a>.</p>

<p>Теперь хочу немного дописать его - развернуть таймлайн в обратную сторону, чтобы современные события были слева (их много), а рождение и детский сад были далеко справа; добавить типы событий (отпуска одним цветом, профессиональная деятельность - другим); сделать русскую версию.</p>

<p>По хорошему, из этого может получиться отличное CV. Вот кстати, еще есть занятное <a href="https://github.com/kaeluka/cv">CV</a> в PDF, его можно немного модифицировать, русифицировать и рассылать в виде резюме.</p>



    
  </div>

  
</article>

  
    
  
  
  



  


<article class="entry">
  <header class="entry-header">
    <h1 class="entry-title">
      <a href="/running-hackernews-on-your-domain/">Запуск HackerNews на своем сайте</a>
    </h1>
  </header>

  <div class="entry-body content-area">
    

    <p>Оказывается, движок форума <a href="http://news.ycombinator.com">HackerNews</a> это open-source проект и такой же движок можно развернуть на своем сервере. Я обнаружил это наткнувшись на статью <a href="http://www.righto.com/2009/06/how-does-newsyc-ranking-work.html">Ken Shirriff’s blog: Inside the news.yc ranking formula</a>, в которой детально описывается формула, как рассчитывается вес статьи и ее позиция в выдаче на форуме.</p>

<p>Итак, HackerNews бежит на движке, написанном на языке <a href="http://arclanguage.org/">Arc</a> (<a href="http://en.wikipedia.org/wiki/Arc_(programming_language)‎">wiki</a>). Это диалект Лиспа, написанный Полом Грэмом, основателем <a href="http://ycombinator.com">YCombinator</a>, венчурного фонда для первоначального финансирования стартапов, для решения различных прикладных задач. Такое ощущение, что сейчас на этом языке решена ровно одна задача – форум HackerNews компании YCombinator.</p>

<p>Ссылок на скачивание arc в явном виде нигде нет, на <a href="arclanguage.org/install">arclanguage.org/install</a>, как оказалось, лежит очень старая и неактуальная информация по установке. Более актуальная информация лежит на сервере <a href="http://tryarc.org">TryArc</a> (там же можно попробовать пописать на Arc прямо в браузере).</p>

<p>Итак, чтобы установить движок HackerNews на свой сервер, надо:</p>

<ol>
  <li>Установить Arc. Подробное описание установки есть <a href="https://sites.google.com/site/arclanguagewiki/getting-started/install-arc">тут</a>. Перед установкой потребуется установить <a href="http://racket-lang.org/">Racket</a> (из бинарников Ракета понадобится только MzScheme), затем сам Arc. Я устанавливал pure Arc, скачав его тут: <a href="http://ycombinator.com/arc/arc3.1.tar">http://ycombinator.com/arc/arc3.1.tar</a></li>
  <li>Распаковать Arc, инструкция по установке и запуска движка лежит внутри дистрибутива в файле <code>how-to-run-news</code>. Выполнив написанное в нем, получим работающий движок на своем сайте.</li>
</ol>

<p>Если потребуется дополнительная информация, то лучше всего ее искать на форуме <a href="http://arclanguage.com/forum">arclanguage</a> гуглом поиском по сайту (добавлять к поисковому запросу <code>site:arclanguage.com</code>). Именно таким образом я нашел как поднять форум на произвольном порту (прописать нужный порт на 82-й строке в файле <code>news.arc</code>) и <a href="http://www.arclanguage.com/item?id=11021">как запустить форум в бэкграунде</a>, чтобы он продолжал работать после закрытия терминальной сессии (с помощью screen, про screen я напишу отдельный пост).</p>

<p>На этом движке я запустил форум для новостей СУБД: <a href="http://ora600.ru">ora600.ru</a>, добро пожаловать. В следующем посте я расскажу, как я настроил nginx для проксирования двух форумов на arc, одного сервиса на flask и одного сайта на apache на один 80-й порт одного сервера, это оказалось крайне простым делом.</p>



    
  </div>

  
</article>

  
    
  
  
  



  


<article class="entry">
  <header class="entry-header">
    <h1 class="entry-title">
      <a href="/informatica-order-of-ports-in-expression/">Порядок портов в Expression Informatica PowerCenter</a>
    </h1>
  </header>

  <div class="entry-body content-area">
    

    <p>Оказывается, порядок портов в expression в Informatica PowerCenter имеет значение. Например, если сделать так:</p>

<pre><code>Номер порта	Имя	Значение
1		v_A	v_B
2		v_B	&lt;вызов лукапа&gt;
</code></pre>

<p>то значение <code>v_A</code> будет определяться от лукапа, выполненного по данным от предыдущей строки.</p>

<p>Пруф из хелпа:</p>

<blockquote>
  <p>Port order. The Integration Service evaluates ports by dependency. The order  of the ports in a transformation must match the order of evaluation: input  ports, variable ports, output ports.</p>
</blockquote>



    
      <a href="/informatica-order-of-ports-in-expression/" class="read-link">Читать</a>
    
  </div>

  
</article>

  
    
  
  
  



  


<article class="entry">
  <header class="entry-header">
    <h1 class="entry-title">
      <a href="/mongo-on-openvz/">MongoDB на OpenVZ</a>
    </h1>
  </header>

  <div class="entry-body content-area">
    

    <p>Для проекта <a href="https://github.com/schmooser/instaflickr">instaflickr</a> решил установить на своем виртуальном хостинге 
<a href="http://www.mongodb.org">MongoDB</a>. Установить просто через <code>yum install mongodb</code> не получилось –
установился пакет <code>mongodb.x86_64</code>, но при этом серверного процесса <code>mongod</code> 
в системе не оказалось, только клиент <code>mongo</code>. Пришлось установить, как описано
в <a href="http://docs.mongodb.org/manual/tutorial/install-mongodb-on-red-hat-centos-or-fedora-linux/">официальной документации</a>. </p>

<p>Когда я запустил <code>mongod</code> и подключился клиентом, то увидел страшное сообщение
об ошибке:</p>

<pre><code>MongoDB shell version: 2.4.8
connecting to: test
Server has startup warnings:

** WARNING: You are running in OpenVZ. This is known to be broken!!!
</code></pre>

<p>Поискал в интернете, кто что пишет по этому поводу. Нашел <a href="http://www.mind-flip.com/theBlog/2013/02/27/running-mongodb-in-a-virtual-environment/">пост в блоге
Mind-Flip Blog</a>. Оказывается, в OpenVZ есть концепция нормальной и
всплесковой (burst) оперативной памяти. Сначала гипервизор выделяет физическую
память для каждой машины, затем, если машине необходимо больше памяти,
гипервизор увеличит размер. Эта дополнительная память и называется всплесковой.
Данная техника в теории работает очень хорошо, но на практике может вызывать
проблемы в работе некоторых приложений. Когда всплесковая память забирается
гипервизором, может получиться, что в этом куске памяти были структуры,
используемые MongoDB.  В этом случае MongoDB просто падает. В 10Gen
(компания-разработчик MongoDB), видимо, нашли проблему и теперь проверяют, что
ОС бежит под OpenVZ и выдают подобное угрожающее сообщение.</p>

<p>Так что я решил воспользоваться бесплатным планом на <a href="http://mongolab.com">MongoLab</a>, они дают 500Мб
бесплатного места на одном инстансе MongoDB.</p>



    
  </div>

  
</article>

  
    
  
  
  



  


<article class="entry">
  <header class="entry-header">
    <h1 class="entry-title">
      <a href="/running-workflow-in-parallel-in-informatica-powercenter/">Параллельный запуск потока в Informatica PowerCenter</a>
    </h1>
  </header>

  <div class="entry-body content-area">
    

    <p>В Informatica PowerCenter есть возможность запускать в параллельном режиме один поток (workflow) в разных инстансах. Данный метод запуска очень выгодно использовать для загрузки данных, которые хорошо партиционируются. Например, загрузку данных за месяц можно запустить параллельно в 4 потока по неделе или сделать подневную загрузку в N потоков.</p>

<p>Количество одновременных потоков надо выбирать исходя из производительности платформы. При увеличении числа потоков сначала идет практически линейный рост производительности, затем все начинает упираться в узкое место платформы (IO, CPU, RAM, Network) и дальнейшее увеличение количества параллельных потоков только замедляет скорость работы системы.</p>

<p>Чтобы поток мог работать в параллельном режиме, надо в настройках потока включить опцию “Configure Concurrent Execution”. В настройках Concurrent Execution лучше использовать опцию “Allow concurrent run only with unique instance name” иначе потом не разберешься какой именно параллельный запуск за какую часть работы отвечает. Нужно указать имя инстанса и параметрический файл. Обычно эти значения совпадают с таковыми у потока.</p>

<p>Запустить поток в параллель возможно только из командной строки через <code>pmcmd</code>. Скорее всего вам понадобится уникальный параметрический файл для каждого инстанса (например, разные периоды загрузки). В этом случае, в вашем диспетчере загрузок или управляющем механизме, который генерирует файл параметров, нужно предусмотреть процедуру сохранения файла параметров с уникальным именем.</p>

<p>Я это делал просто – диспетчер создает параметрический файл <code>wf_WFNAME.param</code> и командный файл для запуска потока. В командном файле сначала файл <code>wf_WFNAME.param</code> копируется в <code>wf_WFNAME_xxxx.param</code>, где <code>xxxx</code> – уникальный номер запуска потока, а затем вызывается <code>pmcmd</code>:</p>

<pre><code>param_dir=/informatica/pc/server/infa_shared/DEV/Param/
bin_dir=/informatica/pc/server/bin 
cp $param_dir/wf_CALC.param $param_dir/wf_CALC_1712.param

$bin_dir/pmcmd startworkflow -service SERVICE_NAME
                             -domain DOMAIN_NAME
                             -user username
                             -password pwd
                             -folder FOLDER_NAME
                             -paramfile $param_dir/wf_WFNAME_1712.param
                             -runinsname wf_WFNAME_1712
                             wf_WFNAME
</code></pre>

<h3 id="to-do">To Do</h3>

<ul>
  <li>добавить скриншоты настроек параллельного запуска</li>
  <li>добавить анализ скорости выполнения задачи от количества параллельных инстансов</li>
  <li>описать работу диспетчера задач</li>
</ul>



    
      <a href="/running-workflow-in-parallel-in-informatica-powercenter/" class="read-link">Читать</a>
    
  </div>

  
</article>

  
    
  
  
  



  


<article class="entry">
  <header class="entry-header">
    <h1 class="entry-title">
      <a href="/raspberry-pi-setup-and-ssh-through-browser/">Установка Raspberry Pi и настройка SSH через браузер</a>
    </h1>
  </header>

  <div class="entry-body content-area">
    

    <p>Настало время поставить что-нибудь дельное на мой Raspberry Pi Model A.</p>

<p><img src="/assets/raspberrypi/raspberry_pi_logo1.png" alt="raspberry pi logo" /></p>

<h2 id="wifi--">ОС, WiFi и драйвера</h2>

<p>В качестве операционной системы поставил <a href="http://www.raspbian.org">Raspbian</a>, сеть – купил WiFi-адаптер <a href="http://www.tp-linkru.com/products/details/?categoryid=243&amp;model=TL-WN725N">TL-WN725N</a> за 310 рублей в Юлмарте.</p>

<p>Драйвера для WiFi-адаптера ставятся простым копированием файлов в нужные директории, полное описание процесса установки есть в блоге <a href="http://www.mendrugox.net/2013/08/tp-link-tl-wn725n-v2-working-on-raspberry-raspbian/">mendrugox</a>. Только надо внимательно следить, чтобы драйвера были скомпилированы именно под нужную версию Raspbian.</p>

<p>Драйвер для версии <code>2013-09-25-wheezy-raspbian</code>: <a href="/assets/raspberrypi/8188eu.ko">8188eu.ko</a> (Compiled in 2013-10) (Working in kernel Linux raspberrypi 3.6.11+ #538 PREEMPT).</p>

<p>Файл кидаем на SD-карточку, после чего из Raspberry находим его в каталоге <code>/boot</code>. Копируем в</p>

<pre><code>/lib/modules/(your-kernel-version)/kernel/drivers/net/wireless
</code></pre>

<p>и запускаем:</p>

<pre><code>depmod -a
modprobe 8188eu
</code></pre>

<p>После этого должно появиться устройство <code>wlan0</code>, с которым можно уже работать.</p>

<p>Исходный код: <a href="/assets/raspberrypi/rtl8188eu.tgz">rtl8188eu.tgz</a></p>

<p>Я не стал мучаться с настройкой WiFi через командную строку, а настроил все через графический интерфейс. Все работает и загружается при старте системы.</p>

<h2 id="ssh-----dns">SSH через браузер и динамический DNS</h2>

<p>Решил поставить браузерную версию ssh, чтобы можно было зайти на него с работы (любой не http(s)-трафик у нас режут).</p>

<p>Для этого сначала поставил <a href="http://nodejs.org">nodejs</a>, затем <a href="https://github.com/chjj/tty.js/">tty.js</a>:</p>

<pre><code>apt-get install nodejs, npm
npm install tty.js
</code></pre>

<p>После этого его сразу можно поднимать и работать:</p>

<pre><code>nodejs tty.js --daemonize
</code></pre>

<p>Конфигурационный файл по-умолчанию лежит в <code>~/.tty.js/config.json</code>.</p>

<p>Единственное, чего я пока не понял – как сделать шелл с приглашением к логину, а то сейчас сразу открывается терминал из под пользователя, запустившего <code>tty.js</code>.</p>

<p>Аутентификация – стандартная HTTP-authentication. Надо будет еще с HTTPS заморочиться, чтобы вообще все было хорошо.</p>

<p>Дальше, выводим наш Raspberry в интернет.</p>

<p>Есть сервис <a href="https://pagekite.net">pagekite</a>, который привязывает к вашему динамическому IP доменное имя вида <code>username.pagekite.me</code>. Бесплатный и с открытым исходным кодом, все настраивается и быстро устанавливается, можно даже привязать свой CNAME.</p>

<p>Все настроил, теперь у меня Raspberry доступен из интернета.</p>

<p>Правда это штука, pagekite, достаточно сильно грузит процессор – примерно 7-8% на сессию. Видимо, программно осуществляет роутинг пакетов.</p>

<p>Надо будет приделать к нему настоящий DDNS. К сожалению, почти все хотят за это сейчас денег, причем немаленьких. Есть наброски по использованию Yandex Public DNS и прописыванием адреса через API. Сделаю – напишу.</p>

<h2 id="section">Скриншоты</h2>

<div class="photos">
  <img src="/assets/raspberrypi/screenshot-1.png" data-caption="Nyancat в терминале, pagekite жрет 25% процессора" />
  <img src="/assets/raspberrypi/screenshot-2.png" data-caption="Без нагрузки pagekite жрет 6-7% процессора" />
</div>



    
  </div>

  
</article>

  
    
  
  
  



  


<article class="entry">
  <header class="entry-header">
    <h1 class="entry-title">
      <a href="/first-word-hyphenation-in-latex/">Перенос первого слова в параграфе в LaTeX</a>
    </h1>
  </header>

  <div class="entry-body content-area">
    

    <p>При верстке таблиц в LaTeX может возникнуть еще одна проблема – если у вас в ячейке одно слово, то LaTeX не будет его переносить, даже если слово длинное и не умещается по ширине в ячейку типа <code>p</code>. Все из-за того, что сложность алгоритма расстановки переносов в случае допущений, в числе которых и отсутствие необходимости переносить первое слово, падает с О(n<sup>2</sup>) до O(n). Подробности <a href="https://en.wikipedia.org/wiki/TeX#Hyphenation_and_justification">в английской Википедии</a>.</p>

<p>Но TeX можно обмануть! Нужно лишь первым символом параграфа сделать неразрывный пробел нулевой длины – <code>\hspace{0pt}</code>. Примеры использования: <a href="http://sigstp.blogspot.ru/2010/09/latex-hyphenate-single-long-words-in.html">раз</a>, <a href="http://tex.stackexchange.com/questions/67762/hyphenation-rule-not-acted-upon">два</a>.</p>

<p>Вставлять каждый раз в нужное место код очень неудобно, особенно если контент приходит из вне, поэтому можно сделать это автоматически. После достаточно долгих поисков я нашел <a href="http://tex.stackexchange.com/questions/78127/how-does-latex-make-line-breaking-for-word-that-can-not-fit-in-cell">вот этот совет</a> на TeX StackExchange – нужно в опциях табличного окружения воспользоваться синтаксисом <code>&gt;{...}</code> из пакета <code>array</code>, например так:</p>

<pre><code>...
\usepackage{array}
...
\begin{longtable}{|&gt;{\hspace{0pt}}p{0.1\textwidth} | p{0.3\textwidth}|} \hline
...
</code></pre>

<p>После этого все сразу станет гораздо красивее.</p>



    
  </div>

  
</article>

  
  <a href="archive.html" class="archive-link">→</a>
</section>



  <!-- Yandex.Metrika counter -->
<script type="text/javascript">
(function (d, w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            w.yaCounter21201856 = new Ya.Metrika({id:21201856,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true});
        } catch(e) { }
    });

    var n = d.getElementsByTagName("script")[0],
        s = d.createElement("script"),
        f = function () { n.parentNode.insertBefore(s, n); };
    s.type = "text/javascript";
    s.async = true;
    s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

    if (w.opera == "[object Opera]") {
        d.addEventListener("DOMContentLoaded", f, false);
    } else { f(); }
})(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="//mc.yandex.ru/watch/21201856" style="position:absolute; left:-9999px;" alt="" /></div>
</noscript>
<!-- /Yandex.Metrika counter -->

</body>
</html>
