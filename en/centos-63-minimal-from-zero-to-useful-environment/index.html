<!DOCTYPE html>
<html lang="ru">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pavel Popov's Blog</title>
  <meta name="title" content="CentOS 6 minimal from zero to useful environment">
  <meta name="description" content="Pavel Popov">

  <meta property="og:url" content="/centos-63-minimal-from-zero-to-useful-environment/">
  <meta property="og:title" content="CentOS 6 minimal from zero to useful environment">
  
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="Pavel Popov">
  <link rel="icon" type="image/png" href="/en/public/favicon.ico">
  <link rel="alternate" type="application/rss+xml" title="Pavel Popov's Blog" href="/blog-feed.xml">
  <link href="http://fonts.googleapis.com/css?family=PT+Serif:400,700,400italic|PT+Sans:400,700,400italic|Roboto:100,300|Roboto+Slab:300,400&amp;subset=latin,cyrillic" rel="stylesheet">
  <link href="/en/public/css/main.css" rel="stylesheet">

  <!-- CSS -->
  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/en/public/apple-touch-icon-precomposed.png">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Custom -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
  <link href="http://fotorama.s3.amazonaws.com/4.4.9/fotorama.css" rel="stylesheet">
  <script src="http://fotorama.s3.amazonaws.com/4.4.9/fotorama.js"></script>
  <script src="/en/public/js/dug.js"></script>
  <script src="/en/public/js/application.js"></script>
</head>

<body>
<header class="row-1">
  <nav class="title-nav" role="navigation">
    <h1 class="title-nav-header"><a href="/">Pavel Popov</a>
      <span class="title-nav-slash">/</span>
      <a href="/en/">Blog</a>
    </h1>
  </nav>
</header>

  <section class="single-entry row-1" role="main">
  
  
  
  




<article class="entry">
  <header class="entry-header">
    <h1 class="entry-title">
      <a href="/en/centos-63-minimal-from-zero-to-useful-environment/">CentOS 6 minimal from zero to useful environment</a>
    </h1>
  </header>

  <div class="entry-body content-area">
    

    <blockquote>
  <p>There is a great post “<a href="http://plusbryan.com/my-first-5-minutes-on-a-server-or-essential-security-for-linux-servers">My First 5 Minutes On A Server</a>”
by Bryan Kennedy which covers security aspects.</p>
</blockquote>

<p>After installing CentOS 6 in minimal configuration you’ll get a simple
login shell with some useful options missed. Let’s install them.</p>

<h2 id="network">Network</h2>

<p>Check it with command <code>ifconfig</code>. If there is only <code>lo</code> interface then network
is shut down. Start it up with </p>

<pre><code>$ ifconfig eth0 up
</code></pre>

<p>Check <code>ifconfig</code> again. If there is no IPv4 address attached to <code>eth0</code>
interface, get one with </p>

<pre><code>$ dhclient eth0
</code></pre>

<p>Then check again, usually everything is ok and you can ping something with <code>ping
ya.ru</code>. If you want to keep this change permanent, so that <code>eth0</code> would start at
boot, you’ve got to change <code>ONBOOT="no"</code> to <code>ONBOOT="yes"</code> in
<code>/etc/sysconfig/network-scripts/ifcfg-eth0</code> config file.</p>

<h2 id="system-settings">System settings</h2>

<p>To turn off 3 seconds delay during startup edit file <code>/etc/grub.conf</code> and set
<code>timeout=0</code>.</p>

<p>If you want to edit hostname, set it in <code>/etc/sysconfig/network</code> under
<code>HOSTNAME</code> option.</p>

<h2 id="users-and-security">Users and security</h2>

<p>Add your primary user use <code>useradd username</code> and then <code>passwd username</code> to
change his password.</p>

<h2 id="vm-tools">VM tools</h2>

<p>For comfort use you need VM tools to be installed. Usually tools are installed
via CD image attached to VM’s CD-ROM. I
<a href="/mounting-cdrom-on-ubuntu-server/">wrote</a> about mounting CD-ROM on Ubuntu
Sever, but I will repeat. Create directory <code>mkdir /media/cdrom</code>, add to
<code>/etc/fstab</code> line <code>/dev/cdrom /media/cdrom auto noauto,sync 0 0</code>, mount CDROM
with <code>mount /media/cdrom</code>.</p>

<p>To install Parallels Tools use <code>/media/cdrom/install</code> to install.</p>

<p>To install VirtualBox additions do:</p>

<pre><code># yum install make -y
# yum install gcc -y
# yum install kernel sources -y
# yum install kernel-devel -y
</code></pre>

<p>Then restart system. After restart, do <code>/media/cdrom/VBoxLinuxAdditions.run</code>.
To uninstall additions, do <code>/media/cdrom/VBoxLinuxAdditions.run uninstall</code>.</p>

<p>For additional info look at <a href="https://forums.virtualbox.org/viewtopic.php?t=4960">VirtualBox forums</a>.</p>

<h2 id="packages">Packages</h2>

<p>I usually also install this packages:</p>

<pre><code># yum install mc sudo unzip man git hg vim nmap -y
</code></pre>

<p>Install zsh if you prefer it to bash with <code># yum install zsh</code>.</p>

<h2 id="firewall">Firewall</h2>

<p>By default CentOS opens only ssh port. To open other ports you have to modify
iptables rules. Manual for using iptables in CentOS is in the <a href="http://wiki.centos.org/HowTos/Network/IPTables">official
documentation</a>.</p>

<p>My usual settings are:</p>

<pre><code>#!/bin/bash
#
# iptables configuration script
#
# Flush all current rules from iptables
iptables -F
#
# Allow SSH connections on tcp port 22
iptables -A INPUT -p tcp --dport 22 -j ACCEPT
#
# Open needful ports
iptables -A INPUT -p tcp --dport 80 -j ACCEPT
iptables -A INPUT -p tcp --dport 8080 -j ACCEPT
iptables -A INPUT -p tcp --dport 1521 -j ACCEPT
#
# Set default policies for INPUT, FORWARD and OUTPUT chains
iptables -P INPUT DROP
iptables -P FORWARD DROP
iptables -P OUTPUT ACCEPT
#
# Set access for localhost
iptables -A INPUT -i lo -j ACCEPT
#
# Accept packets belonging to established and related connections
iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
#
# Save settings
/sbin/service iptables save
#
# List rules
iptables -L -v
</code></pre>

<p><em>The following sections are optional if you need them on this very machine.</em></p>

<h2 id="java">Java</h2>

<p>To install JRE download appropriate .tar.gz for your distribution, then unpack
it into <code>/usr/java/</code> and make symlinks <code>current</code> and <code>latest</code> pointed to it. In
my case it was:</p>

<pre><code>ln -s jre1.7.0_10 current
ln -s jre1.7.0_10 latest
</code></pre>

<p>Then add <code>/usr/java/current/bin</code> into your <code>~/.profile</code> file:</p>

<pre><code>export PATH=$PATH:/usr/java/current/bin
</code></pre>

<p>Check if java is installed correctly:</p>

<pre><code>java -version
</code></pre>

<p>If there is an error</p>

<pre><code>bash: /usr/java/current/bin/java: /lib/ld-linux.so.2: bad ELF interpreter
</code></pre>

<p>try to install package </p>

<pre><code>yum install glibc.i686
</code></pre>

<h2 id="oracle-instant-client">Oracle instant client</h2>

<ol>
  <li>
    <p>Download files <code>instantclient-basic-linux-11.2.0.3.0.zip</code> and
<code>instantclient-sqlplus-linux-11.2.0.3.0.zip</code> from <a href="http://www.oracle.com/technetwork/database/features/instant-client/index-097480.html">Oracle Instant Client
download area</a>. Be sure to download
appropriate version for your OS. If you use 64-bit OS then download x86_64
version of instant client. Unzip them somewhere, eg.
<code>/opt/oracle/instantclient_11_2</code>.</p>
  </li>
  <li>
    <p>Install <code>libaio</code> package.</p>
  </li>
  <li>
    <p>Add this environment variables to <code>.profile</code> or <code>.bashrc</code>:</p>

    <pre><code>export ORACLE_HOME=/opt/oracle/instantclient_11_2
export LD_LIBRARY_PATH=/opt/oracle/instantclient_11_2
export TNS_ADMIN=$ORACLE_HOME/network/admin/
export NLS_LANG=AMERICAN_AMERICA.UTF8
export PATH=$PATH:$ORACLE_HOME
</code></pre>
  </li>
  <li>
    <p>Add file <code>$TNS\_ADMIN/tnsnames.ora</code> with content like this:</p>

    <pre><code>ORCL =
(DESCRIPTION =
  (ADDRESS = 
    (PROTOCOL = TCP)
    (HOST = hostname)
    (PORT = 1521) 
  )
  (CONNECT_DATA =
    (SERVER = DEDICATED)
    (SERVICE_NAME = sid)
  )
)
</code></pre>
  </li>
</ol>

<p>Of course, you can use another path instead of <code>/opt/oracle</code> to put instant
client files.</p>



    
  </div>

  
  <footer class="entry-footer">
    <time class="entry-timestamp">11 Jan 2013</time>
  </footer>
  
</article>

</section>



  <!-- Yandex.Metrika counter -->
<script type="text/javascript">
(function (d, w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            w.yaCounter21201856 = new Ya.Metrika({id:21201856,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true});
        } catch(e) { }
    });

    var n = d.getElementsByTagName("script")[0],
        s = d.createElement("script"),
        f = function () { n.parentNode.insertBefore(s, n); };
    s.type = "text/javascript";
    s.async = true;
    s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

    if (w.opera == "[object Opera]") {
        d.addEventListener("DOMContentLoaded", f, false);
    } else { f(); }
})(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="//mc.yandex.ru/watch/21201856" style="position:absolute; left:-9999px;" alt="" /></div>
</noscript>
<!-- /Yandex.Metrika counter -->

</body>
</html>
