---
layout: post
title: Параллельный запуск потока в Informatica Power Center
lang: ru
category: informatica
---

В Informatica Power Center есть возможность запускать в параллельном режиме один поток (workflow) в разных инстансах. Данный метод запуска очень выгодно использовать для загрузки данных, которые хорошо партиционируются. Например, загрузку данных за месяц можно запустить параллельно в 4 потока по неделе или сделать подневную загрузку в N потоков.

Количество одновременных потоков надо выбирать исходя из производительности платформы. При увеличении числа потоков сначала идет практически линейный рост производительности, затем все начинает упираться в узкое место платформы (IO, CPU, RAM, Network) и дальнейшее увеличение количества параллельных потоков только замедляет скорость работы системы.

Чтобы поток мог работать в параллельном режиме, надо в настройках потока включить опцию "Configure Concurrent Execution". В настройках Concurrent Execution лучше использовать опцию "Allow concurrent run only with unique instance name" иначе потом не разберешься какой именно параллельный запуск за какую часть работы отвечает. Нужно указать имя инстанса и параметрический файл. Обычно эти значения совпадают с таковыми у потока.

Запустить поток в параллель возможно только из командной строки через `pmcmd`. Скорее всего вам понадобится уникальный параметрический файл для каждого инстанса (например, разные периоды загрузки). В этом случае, в вашем диспетчере загрузок или управляющем механизме, который генерирует файл параметров, нужно предусмотреть процедуру сохранения файла параметров с уникальным именем.

Я это делал просто -- диспетчер создает параметрический файл `wf_WFNAME.param` и командный файл для запуска потока. В командном файле сначала файл `wf_WFNAME.param` копируется в `wf_WFNAME_xxxx.param`, где `xxxx` -- уникальный номер запуска потока, а затем вызывается `pmcmd`:
  
    param_dir=/informatica/pc/server/infa_shared/DEV/Param/
    bin_dir=/informatica/pc/server/bin 
    cp $param_dir/wf_CALC.param $param_dir/wf_CALC_1712.param
    $bin_dir/pmcmd startworkflow -service SERVICE_NAME -domain DOMAIN_NAME -user username -password pwd -folder FOLDER_NAME -paramfile $param_dir/wf_WFNAME_1712.param  -runinsname wf_WFNAME_1712 wf_WFNAME


### ToDo

* добавить скриншоты настроек параллельного запуска
* добавить анализ скорости выполнения задачи от количества параллельных инстансов
* описать работу диспетчера задач
